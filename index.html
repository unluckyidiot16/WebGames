<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WebGames | unluckyidiot16</title>
  <meta name="description" content="안재형의 웹게임 모음. 수업/프로토타입/미니게임을 한 곳에서 플레이!" />
  <meta property="og:title" content="WebGames | unluckyidiot16" />
  <meta property="og:description" content="안재형의 웹게임 모음. 수업/프로토타입/미니게임을 한 곳에서 플레이!" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://unluckyidiot16.github.io/WebGames/" />
  <meta name="color-scheme" content="light dark" />
  <style>
    :root{
      --bg:#0b0f14; --fg:#e8eef4; --muted:#9db1c1; --card:#121821; --accent:#61d3ff; --accent-2:#a4ff9b;
      --border: color-mix(in oklab, var(--fg) 10%, transparent);
    }
    @media (prefers-color-scheme: light){
      :root{ --bg:#f7f9fb; --fg:#0e141b; --muted:#516170; --card:#ffffff; --border:#e8eef4; --accent:#0ea5e9; --accent-2:#16a34a; }
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{ margin:0; font:16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, Apple SD Gothic Neo, \"Apple SD Gothic Neo\", \"Noto Sans KR\", sans-serif; background:var(--bg); color:var(--fg); }
    a{ color:var(--accent); text-decoration:none }
    a:hover{ text-decoration:underline }
    .container{ max-width:1200px; margin:0 auto; padding:24px; }
    header{ display:flex; align-items:center; gap:16px; justify-content:space-between; padding:20px 0 8px; }
    .brand{ display:flex; align-items:center; gap:12px; }
    .logo{ width:36px; height:36px; border-radius:10px; background:linear-gradient(135deg,var(--accent),var(--accent-2)); box-shadow:0 6px 24px color-mix(in oklab, var(--accent) 20%, transparent); }
    h1{ font-size:22px; margin:0; letter-spacing:0.2px; }
    .nav{ display:flex; gap:10px; align-items:center; }
    .btn{ display:inline-flex; align-items:center; gap:8px; padding:10px 14px; background:var(--card); border:1px solid var(--border); border-radius:12px; color:var(--fg); text-decoration:none; transition:transform .06s ease, background .2s ease; }
    .btn:hover{ transform:translateY(-1px); text-decoration:none; }

    .controls{ display:grid; grid-template-columns: 1fr auto; gap:12px; margin:16px 0 12px; }
    .search{ display:flex; align-items:center; gap:10px; padding:10px 12px; background:var(--card); border:1px solid var(--border); border-radius:12px; }
    .search input{ flex:1; border:0; outline:0; background:transparent; color:var(--fg); font-size:15px; }
    .select{ padding:10px 12px; background:var(--card); border:1px solid var(--border); border-radius:12px; color:var(--fg); }

    .filters{ display:flex; gap:8px; flex-wrap:wrap; margin:8px 0 18px; }
    .chip{ padding:6px 10px; border:1px solid var(--border); border-radius:999px; background:color-mix(in oklab, var(--card) 70%, transparent); cursor:pointer; font-size:13px; color:var(--muted); }
    .chip.active{ background:linear-gradient(135deg, color-mix(in oklab,var(--accent) 12%, transparent), color-mix(in oklab,var(--accent-2) 10%, transparent)); color:var(--fg); border-color: color-mix(in oklab, var(--accent) 40%, var(--border)); }

    .grid{ display:grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap:14px; }
    .card{ background:var(--card); border:1px solid var(--border); border-radius:18px; overflow:hidden; display:flex; flex-direction:column; min-height:280px; }
    .thumb{ aspect-ratio: 16 / 9; width:100%; background:linear-gradient(135deg, #253041, #151c27); display:grid; place-items:center; color:#9fb2c8; font-weight:600; letter-spacing:0.3px; }
    .thumb img{ width:100%; height:100%; object-fit:cover; display:block; }
    .card-body{ padding:14px; display:flex; flex-direction:column; gap:8px; }
    .title{ font-size:16px; font-weight:700; margin:0; }
    .desc{ color:var(--muted); font-size:13.5px; margin:0; }
    .meta{ display:flex; justify-content:space-between; align-items:center; font-size:12px; color:var(--muted); }
    .tags{ display:flex; gap:6px; flex-wrap:wrap; }
    .tag{ font-size:11px; padding:4px 8px; border:1px solid var(--border); border-radius:999px; color:var(--muted); }
    .actions{ display:flex; gap:8px; margin-top:8px; }
    .play{ flex:1; text-align:center; padding:10px 12px; border-radius:12px; border:1px solid var(--border); background:linear-gradient(135deg, color-mix(in oklab, var(--accent) 18%, transparent), color-mix(in oklab, var(--accent-2) 12%, transparent)); color:var(--fg); text-decoration:none; font-weight:600; }

    .empty{ text-align:center; padding:48px 8px; color:var(--muted); border:1px dashed var(--border); border-radius:16px; background:color-mix(in oklab, var(--card) 80%, transparent); }

    footer{ color:var(--muted); font-size:12.5px; text-align:center; margin:28px 0 10px; }
    code.kbd{ padding:2px 6px; border-radius:6px; border:1px solid var(--border); background:color-mix(in oklab, var(--card) 70%, transparent); font-family:ui-monospace, SFMono-Regular, Menlo, monospace; font-size:12px; }
  </style>
</head>
<body>
<div class="container">
  <header>
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <div>
        <h1>WebGames</h1>
        <div style="font-size:13px; color:var(--muted);">수업 · 프로토타입 · 미니게임 모음</div>
      </div>
    </div>
    <nav class="nav">
      <a class="btn" href="https://github.com/unluckyidiot16/WebGames" target="_blank" rel="noopener">GitHub</a>
    </nav>
  </header>

  <section class="controls" role="search">
    <label class="search" style="grid-column: span 2;">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21 21l-4.3-4.3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2"/></svg>
      <input id="q" type="search" placeholder="게임 검색 (제목/태그)" autocomplete="off" />
    </label>
    <select id="sort" class="select" aria-label="정렬">
      <option value="updated-desc">최신 업데이트 순</option>
      <option value="title-asc">제목 A→Z</option>
      <option value="title-desc">제목 Z→A</option>
    </select>
    <div style="align-self:center; justify-self:end; font-size:13px; color:var(--muted);">
      <span id="count">0</span>개 게임
    </div>
  </section>

  <div class="filters" id="filters" aria-label="장르/태그 필터"></div>

  <section class="grid" id="grid" aria-live="polite" aria-busy="true"></section>

  <div id="empty" class="empty" hidden>
    결과가 없습니다. 검색어나 필터를 변경해보세요.
  </div>

  <footer>
  </footer>
</div>

<script>
  // 기본 게임 목록 (games.json이 없으면 이걸 사용)
  const DEFAULT_GAMES = [
    {
      title: "Flappy Boat",
      url: "https://unluckyidiot16.github.io/assets-common/FlappyBoat/FlappyBoat.html",
      thumb: "https://unluckyidiot16.github.io/assets-common/FlappyBoat/thumbnail.png",
      tags: ["교육","아케이드"],
      updated: "2025-09-30",
      desc: "플래피 버드 느낌의 밀물·썰물 타이밍 학습용 변주"
    }
    // 필요 시 여기에 더 추가하거나 games.json을 사용하세요.
  ];

  const $q = document.getElementById('q');
  const $grid = document.getElementById('grid');
  const $filters = document.getElementById('filters');
  const $count = document.getElementById('count');
  const $sort = document.getElementById('sort');
  const $empty = document.getElementById('empty');

  const asDate = (s) => s ? new Date(s) : new Date(0);

  function placeholderSVG(text){
    const t = encodeURIComponent(text);
    const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='800' height='450'>\n  <defs>\n    <linearGradient id='g' x1='0' y1='0' x2='1' y2='1'>\n      <stop offset='0%' stop-color='%23253041'/>\n      <stop offset='100%' stop-color='%23151c27'/>\n    </linearGradient>\n  </defs>\n  <rect width='100%' height='100%' fill='url(%23g)'/>\n  <text x='50%' y='50%' text-anchor='middle' fill='%239fb2c8' font-family='system-ui, -apple-system, Segoe UI, Roboto, Noto Sans KR' font-size='42' font-weight='700'>${t}</text>\n</svg>`;
    return `data:image/svg+xml;utf8,${svg}`;
  }

  function cardTemplate(g){
    const tags = (g.tags||[]).map(t => `<span class='tag'>#${escapeHtml(t)}</span>`).join('');
    const updated = g.updated ? new Date(g.updated).toLocaleDateString('ko-KR') : '';
    const img = g.thumb || placeholderSVG(g.title || 'Game');
    return `
        <article class="card">
          <div class="thumb"><img alt="${escapeHtml(g.title||'게임 썸네일')}" loading="lazy" referrerpolicy="no-referrer" /></div>
          <div class="card-body">
            <h3 class="title">${escapeHtml(g.title||'제목 미정')}</h3>
            <p class="desc">${escapeHtml(g.desc||'설명이 아직 없습니다.')}</p>
            <div class="meta">
              <div class="tags">${tags}</div>
              <div>${updated?`업데이트 ${updated}`:''}</div>
            </div>
            <div class="actions">
              <a class="play" href="${escapeAttr(g.url||'#')}" target="_blank" rel="noopener">▶ 플레이</a>
            </div>
          </div>
        </article>`;
  }

  function escapeHtml(s){
    return String(s).replace(/[&<>\"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;','\'':'&#39;'}[c]));
  }
  function escapeAttr(s){
    return String(s).replace(/\"/g,'&quot;');
  }

  function applyImages(){
    document.querySelectorAll('.card .thumb img').forEach((imgEl, i) => {
      const g = current[i];
      const src = (g && g.thumb) ? g.thumb : placeholderSVG(g?.title||'Game');
      imgEl.src = src;
      imgEl.onerror = () => { imgEl.src = placeholderSVG(g?.title||'Game'); };
    });
  }

  let all = [];
  let current = [];
  let activeTag = null;

  function render(){
    let items = [...all];
    const q = $q.value.trim().toLowerCase();
    if(q){
      items = items.filter(g =>
              (g.title||'').toLowerCase().includes(q) ||
              (g.desc||'').toLowerCase().includes(q) ||
              (g.tags||[]).some(t => (t||'').toLowerCase().includes(q))
      );
    }
    if(activeTag){
      items = items.filter(g => (g.tags||[]).includes(activeTag));
    }
    const sort = $sort.value;
    items.sort((a,b)=>{
      if(sort==='updated-desc') return asDate(b.updated) - asDate(a.updated);
      if(sort==='title-asc') return (a.title||'').localeCompare(b.title||'','ko');
      if(sort==='title-desc') return (b.title||'').localeCompare(a.title||'','ko');
      return 0;
    });

    current = items;
    $count.textContent = String(items.length);
    $grid.innerHTML = items.map(cardTemplate).join('');
    $grid.setAttribute('aria-busy','false');
    $empty.hidden = items.length > 0;
    applyImages();
  }

  function buildFilterChips(){
    const tagSet = new Set();
    all.forEach(g => (g.tags||[]).forEach(t => t && tagSet.add(t)));
    const tags = Array.from(tagSet).sort((a,b)=> a.localeCompare(b,'ko'));
    $filters.innerHTML = ['전체', ...tags].map(tag=>{
      const isAll = tag==='전체';
      const active = isAll ? (activeTag===null) : (activeTag===tag);
      return `<button class="chip ${active?'active':''}" data-tag="${isAll?"":escapeAttr(tag)}">${tag}</button>`;
    }).join('');

    $filters.querySelectorAll('button').forEach(btn => {
      btn.addEventListener('click', () => {
        const t = btn.dataset.tag;
        activeTag = t ? t : null; // 빈 문자열이면 전체
        $filters.querySelectorAll('button').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        render();
      });
    });
  }

  async function load(){
    let data = DEFAULT_GAMES;
    try{
      const res = await fetch('games.json', { cache: 'no-store' });
      if(res.ok){ data = await res.json(); }
    }catch(e){ /* games.json이 없으면 기본값 사용 */ }
    // 정규화
    all = (Array.isArray(data)?data:[]).map(g=>({
      title: g.title||'', url: g.url||'#', thumb: g.thumb||'', tags: Array.isArray(g.tags)?g.tags:[],
      updated: g.updated||'', desc: g.desc||''
    }));
    buildFilterChips();
    render();
  }

  $q.addEventListener('input', render);
  $sort.addEventListener('change', render);

  load();
</script>
</body>
</html>
